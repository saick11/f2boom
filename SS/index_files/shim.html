<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","","87e632939661-f2boom_soul_pure.html-671")</script><script>'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>生日花語繪日誌 | 花菓波 f2boom</title>
    <script src="https://cdn.tailwindcss.com/"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&amp;family=Noto+Sans+TC:wght@300;400;500&amp;display=swap" rel="stylesheet">
    <style>
        :root {
            --brand-gold: #b08d6d;
            --brand-bg: #fdfaf7;
            --paper-clean: #fffbf8;
            --text-main: #4a4238;
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--brand-bg);
            color: var(--text-main);
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        .serif { font-family: 'Noto Serif TC', serif; }
        
        .brand-card {
            background-color: var(--paper-clean);
            border-radius: 40px;
            box-shadow: 0 10px 40px rgba(176, 141, 109, 0.05);
            border: 1px solid rgba(176, 141, 109, 0.1);
            padding: 40px 24px;
            position: relative;
            overflow: hidden;
        }

        .date-input-container {
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(238, 225, 211, 0.5);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 24px;
            position: relative;
            z-index: 10;
        }

        #datePicker {
            position: absolute;
            inset: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 20;
        }

        .brand-btn {
            background: linear-gradient(135deg, #b8987a 0%, #d4a373 100%);
            color: white;
            border-radius: 24px;
            font-size: 1.1rem;
            letter-spacing: 0.2em;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(184, 152, 122, 0.2);
            width: 100%;
            padding: 20px 0;
            cursor: pointer;
            border: none;
            position: relative;
            z-index: 30;
        }

        .audio-wave {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            height: 18px;
            margin-top: 15px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .audio-wave.active { opacity: 1; }
        .bar {
            width: 1.5px;
            height: 100%;
            background: var(--brand-gold);
            border-radius: 1px;
            animation: wave 1.5s infinite ease-in-out;
        }
        @keyframes wave {
            0%, 100% { height: 3px; }
            50% { height: 18px; }
        }

        .botanical-tag {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(5px);
            padding: 8px 15px;
            border-radius: 2px;
            font-size: 11px;
            z-index: 10;
            letter-spacing: 0.15em;
            color: #555;
            border-left: 2px solid var(--brand-gold);
        }

        .art-frame {
            position: relative;
            background: #ffffff;
            padding: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.06);
            border-radius: 4px;
        }

        .linktree-btn {
            display: inline-block;
            position: relative;
            z-index: 50;
            padding: 12px 24px;
            border-bottom: 1px solid #b08d6d;
            color: #4a4238;
            font-weight: 500;
            letter-spacing: 0.3em;
            font-size: 14px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .fade-in { animation: fadeIn 1.5s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.mb-10{margin-bottom:2.5rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-8{margin-bottom:2rem}.ml-3{margin-left:0.75rem}.mt-1{margin-top:0.25rem}.mt-12{margin-top:3rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.aspect-\[4\/5\]{aspect-ratio:4/5}.h-0\.5{height:0.125rem}.h-10{height:2.5rem}.h-full{height:100%}.min-h-screen{min-height:100vh}.w-10{width:2.5rem}.w-full{width:100%}.max-w-md{max-width:28rem}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.space-y-12 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(3rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(3rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-l{border-left-width:1px}.border-t{border-top-width:1px}.border-stone-100{--tw-border-opacity:1;border-color:rgb(245 245 244 / var(--tw-border-opacity, 1))}.border-stone-200{--tw-border-opacity:1;border-color:rgb(231 229 228 / var(--tw-border-opacity, 1))}.border-t-\[\#b08d6d\]{--tw-border-opacity:1;border-top-color:rgb(176 141 109 / var(--tw-border-opacity, 1))}.bg-\[\#f1e09d\]{--tw-bg-opacity:1;background-color:rgb(241 224 157 / var(--tw-bg-opacity, 1))}.bg-stone-50{--tw-bg-opacity:1;background-color:rgb(250 250 249 / var(--tw-bg-opacity, 1))}.object-cover{object-fit:cover}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.pb-24{padding-bottom:6rem}.pb-8{padding-bottom:2rem}.pl-6{padding-left:1.5rem}.pt-12{padding-top:3rem}.pt-14{padding-top:3.5rem}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[10px\]{font-size:10px}.text-\[15px\]{font-size:15px}.text-\[16px\]{font-size:16px}.text-\[17px\]{font-size:17px}.text-\[9px\]{font-size:9px}.text-sm{font-size:0.875rem;line-height:1.25rem}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-loose{line-height:2}.leading-relaxed{line-height:1.625}.tracking-\[0\.15em\]{letter-spacing:0.15em}.tracking-\[0\.2em\]{letter-spacing:0.2em}.tracking-\[0\.3em\]{letter-spacing:0.3em}.tracking-\[0\.4em\]{letter-spacing:0.4em}.tracking-\[0\.5em\]{letter-spacing:0.5em}.tracking-widest{letter-spacing:0.1em}.text-\[\#b08d6d\]{--tw-text-opacity:1;color:rgb(176 141 109 / var(--tw-text-opacity, 1))}.text-stone-300{--tw-text-opacity:1;color:rgb(214 211 209 / var(--tw-text-opacity, 1))}.text-stone-400{--tw-text-opacity:1;color:rgb(168 162 158 / var(--tw-text-opacity, 1))}.text-stone-500{--tw-text-opacity:1;color:rgb(120 113 108 / var(--tw-text-opacity, 1))}.text-stone-600{--tw-text-opacity:1;color:rgb(87 83 78 / var(--tw-text-opacity, 1))}.text-stone-700{--tw-text-opacity:1;color:rgb(68 64 60 / var(--tw-text-opacity, 1))}.text-stone-800{--tw-text-opacity:1;color:rgb(41 37 36 / var(--tw-text-opacity, 1))}.opacity-40{opacity:0.4}</style></head>
<body class="min-h-screen flex flex-col items-center px-6 pt-12 pb-24">

    <header class="text-center mb-12">
        <div class="inline-block relative mb-4">
            <span class="serif text-2xl font-bold tracking-[0.4em] text-[#b08d6d]">花菓波 f2boom</span>
            <div class="h-0.5 w-full bg-[#f1e09d] mt-1 opacity-40"></div>
        </div>
        <h1 class="serif text-2xl font-bold text-stone-700 mb-2">生日花語繪日誌</h1>
        <p class="text-stone-400 text-[9px] tracking-[0.3em] font-light uppercase">Pure Essence &amp; Solar Resonance</p>
    </header>

    <main class="w-full max-w-md">
        <div class="brand-card text-center mb-12">
            <p class="text-stone-500 text-[15px] mb-10 serif tracking-[0.15em]">「 探尋那朵專屬於你的靈魂之花 」</p>
            
            <div class="date-input-container">
                <span id="dateText" class="text-stone-300">輸入誕生日期</span>
                <input type="date" id="datePicker" onchange="updateDateDisplay()">
            </div>
            
            <button onclick="runOracle()" class="brand-btn font-medium">鑑定生日花</button>

            <div id="audioVisualizer" class="audio-wave">
                <div class="bar" style="animation-delay: 0.1s"></div>
                <div class="bar" style="animation-delay: 0.3s"></div>
                <div class="bar" style="animation-delay: 0.5s"></div>
                <div class="bar" style="animation-delay: 0.2s"></div>
                <div class="bar" style="animation-delay: 0.4s"></div>
                <span class="text-[9px] text-stone-400 ml-3 tracking-[0.2em] uppercase">共鳴中</span>
            </div>
        </div>

        <div id="resultArea" class="hidden space-y-12 fade-in">
            <div class="art-frame">
                <div id="imageFrame" class="relative aspect-[4/5] bg-stone-50 overflow-hidden">
                    <div id="botanicalTag" class="botanical-tag hidden">
                        <span id="latinName" class="italic">--</span>
                    </div>
                    <img id="flowerImage" class="hidden w-full h-full object-cover" src="">
                    <div id="loadingOverlay" class="absolute inset-0 flex flex-col items-center justify-center bg-stone-50/98">
                        <div class="w-10 h-10 border border-stone-100 border-t-[#b08d6d] rounded-full animate-spin"></div>
                    </div>
                </div>
            </div>

            <div class="brand-card">
                <div class="border-b border-stone-100 pb-8 mb-10 text-center">
                    <span id="resCoord" class="text-stone-300 text-[10px] tracking-[0.5em] uppercase block mb-3">Temporal Trace</span>
                    <h2 id="resName" class="serif text-4xl font-bold text-stone-800 tracking-widest">--</h2>
                </div>

                <div class="space-y-12">
                    <div>
                        <h3 class="text-[10px] font-bold text-stone-300 mb-5 tracking-[0.4em] uppercase">靈魂之花</h3>
                        <p id="resMeaning" class="text-stone-700 text-[17px] leading-loose serif italic px-2"></p>
                    </div>

                    <div>
                        <h3 class="text-[10px] font-bold text-stone-300 mb-5 tracking-[0.4em] uppercase">時空的耳語</h3>
                        <p id="resAction" class="text-stone-600 text-[16px] leading-relaxed pl-6 border-l border-stone-200 serif"></p>
                    </div>
                </div>

                <div class="pt-14 mt-12 border-t border-stone-100 text-center">
                    <p class="text-stone-400 text-sm italic mb-8 tracking-widest">
                        與花菓波一起，在花香中感受生活
                    </p>
                    <a href="https://linktr.ee/thef2boom" target="_blank" rel="noopener noreferrer" class="linktree-btn">
                       FIND YOUR BLOSSOM
                    </a>
                </div>
            </div>
        </div>
    </main>

    <script>
        const apiKey = "";
        let audioCtx = null;

        // 節氣數據
        const solarTermInsights = {
            "小寒": "寒氣正深，是回歸內在最好的時刻。在沈默中梳理思緒，妳會發現那些微小的光亮正溫柔地指引方向。",
            "大寒": "在冷冽的靜謐中，適合聽見靈魂深處最純粹的頻率。不需要急著綻放，蓄積能量也是一種溫暖的成長。",
            "立春": "春日初始，生命的期許正悄然發芽。這是一個適合『勇敢開始』的時刻，去觸碰那些未曾被察覺的美好。",
            "雨水": "細雨潤物，生命正在溫潤中緩緩甦醒。學會接納那些看似柔軟的力量，它們終將匯聚成不可忽視的生機。",
            "驚蟄": "雷鳴驚醒萬物，內在的勇氣也應隨之覺醒。放下恐懼，讓直覺帶領妳跨出關鍵的一步。",
            "春分": "平衡的時刻。在白晝與黑夜交替間，感受那份不多不少的和諧，讓心靈重獲秩序與平靜。",
            "清明": "萬物潔淨明朗，適合掃去心靈的塵土。給自己一個透氣的空間，去感受生命中最純淨的本質。",
            "穀雨": "雨生百穀，正是滋養夢想的好季節。沈下心來耕耘內在，時間會給予最誠實的饋贈。",
            "立夏": "夏日光影漸長，萬物正值繁茂。感受生命中那份不可阻擋的生命力，大膽去擴張妳的視界。",
            "小滿": "未滿才是最豐實的狀態。在追求完美的路上留下一點餘裕，那份從容會讓妳的美更加持久。",
            "芒種": "忙碌而充實，生命的韻律在指尖流動。享受付出的過程，妳所播下的每一顆種子都有其意義。",
            "夏至": "陽氣至極，感受最極致的光與熱。將內在的熱情釋放，去照亮那些妳所珍視的人事物。",
            "小暑": "微熱的季節，需要一點沈靜的智慧。在浮躁中尋找清涼，保持一顆通透且不被左右的心。",
            "大暑": "在極致的熱情與光照下，適合揮灑所有的能量。這是一份對生命的熱烈擁抱，去綻放最耀眼的光芒。",
            "立秋": "微風帶走暑氣，生命進入更深邃的沈澱。在豐盛與內斂之間，找尋最舒適的節奏。",
            "處暑": "暑氣漸退，是整理收穫的時候了。學會斷捨離，讓靈魂在簡約中重新獲得飛翔的力量。",
            "白露": "露水漸重，提醒我們珍惜那些纖細而易逝的美好。在清晨的微光中，感謝自己一路走來的堅持。",
            "秋分": "收穫與平衡的季節。在明亮而剔透的秋光中，整理內心的秩序，找回妳的那份從容與頻率。",
            "寒露": "寒氣露凝，生命趨於沈穩。專注於妳真正熱愛的事物，那份執著會讓妳在清冷中依然溫暖。",
            "霜降": "寒霜將至，大地的色彩更顯濃烈。這象徵著深度的轉化，在改變中看見更成熟、更完整的自己。",
            "立冬": "萬物收藏，生命進入修復的循環。溫柔地對待自己，將溫暖轉向內在，為下一季的綻放做準備。",
            "小雪": "雪花雖微，卻能覆蓋萬物。體會平淡生活中的神聖性，每一件小事都值得被細心對待。",
            "大雪": "天地蒼茫，在大雪中回歸絕對的安靜。這是與自我深度對話的時刻，在沈默中感受生命的重量。",
            "冬至": "最長的黑夜是為了守護內在的光。在安靜中感受那份沈穩且有力量的保護感，光亮終會回歸。"
        };

        const coreStyle = "Professional editorial photography, soft morning window light, realistic textures, high-end minimalist interior, artistic composition, sharp petals, creamy bokeh, neutral tones.";

        // 100 種純淨花卉庫 (已移除「變奏」字樣)
        const flowers = [
            { name: "大馬士革玫瑰", latin: "Rosa damascena", meaning: "妳擁有一種『帶刺的慈愛』。玫瑰的重瓣是為了守護核心的芳香，刺則是靈魂的邊界；妳深知唯有守住自我的稜角，那份優雅才不至於淪為廉價的討好。", vessel: "textured ceramic teacup" },
            { name: "洋桔梗", latin: "Eustoma russellianum", meaning: "在『柔軟中藏著頑強』。如綢緞般輕盈的花瓣，卻能在多變環境中持續綻放；象徵妳內在不可摧毀的韌性，越顯纖細，內核越是剛強。", vessel: "elegant ribbed glass vase" },
            { name: "帝王花", latin: "Protea cynaroides", meaning: "妳的質地是『原始且孤傲的』。身為最古老的植物之一，那種木質般的堅毅與碩大花冠，是妳與生俱來對時間與荒野的對抗。", vessel: "brutalist concrete plinth" },
            { name: "鈴蘭", latin: "Convallaria majalis", meaning: "一種『沈默的召喚』。微小鐘形花朵在深谷低調綻放，代表妳深藏的純粹——不需高聲喧嘩，幽香自然會引發共鳴。", vessel: "antique medicine bottle" },
            { name: "嘉蘭百合", latin: "Gloriosa superba", meaning: "擁有『燃燒的野心』。反捲的花瓣如躍動的火焰，象徵妳不甘平凡、極具生命張力的靈魂；妳追求的是具備掠奪性的美學。", vessel: "modern metal stand" },
            { name: "黑種草", latin: "Nigella damascena", meaning: "妳是『霧中的迷途者』。煙霧般的細葉環繞深邃花心，代表妳思維中那種難以捉摸、帶有神祕層次的哲思質感。", vessel: "raw terracotta bowl" },
            { name: "臘梅", latin: "Chimonanthus praecox", meaning: "『寒冬中的孤勇』。在冷冽時刻綻放清幽，代表妳有一種在逆境中保持清醒與自尊的高潔特質。", vessel: "weathered wood block" },
            { name: "馬蹄蓮", latin: "Zantedeschia aethiopica", meaning: "『極簡的純粹主義』。流暢的一體化結構，象徵妳追求化繁為簡的人生態度；妳本身就是一套完整的風景。", vessel: "sleek porcelain tube" },
            { name: "芍藥", latin: "Paeonia lactiflora", meaning: "擁有『富饒的安靜』。大氣並非來自炫耀，而是一種底氣十足的坦然，一種不需要向外界證明的富足感。", vessel: "classic white celadon vase" },
            { name: "巧克力秋英", latin: "Cosmos atrosanguineus", meaning: "『深沉且誘人的氣息』。天鵝絨般的質地與溫暖可可香，代表妳有一種不隨大眾起舞的獨特審美。", vessel: "dark bronze organic tray" },
            { name: "向日葵", latin: "Helianthus annuus", meaning: "『追逐光亮的執念』。始終望向太陽的本能，讓妳即使身處陰霾，也能直覺地尋找到希望的出口。", vessel: "rustic stoneware pitcher" },
            { name: "鳶尾花", latin: "Iris germanica", meaning: "妳是『流動的詩意』。優雅的垂瓣曲線象徵思維的靈動；妳擅長在平凡中捕捉稍縱即逝的美感。", vessel: "sculptural matte vessel" },
            { name: "大理花", latin: "Dahlia pinnata", meaning: "『秩序中的繁複美學』。對稱排列的花瓣是對細節的極致追求；妳總能將複雜的生活化為有序的精巧。", vessel: "geometric stone basin" },
            { name: "銀蓮花", latin: "Anemone coronaria", meaning: "帶有一種『纖細的敏感』。花瓣中心的深邃如眼眸，對周遭變化極為敏銳，擁有過人的共情能量。", vessel: "marble display slab" },
            { name: "小蒼蘭", latin: "Freesia hybrida", meaning: "妳是『清爽的清新感』。香氣甜而不膩且層次分明；代表妳待人接物的分寸感，總能讓人如沐春風。", vessel: "frosted pastel glass" },
            { name: "針墊花", latin: "Leucospermum", meaning: "『外放的原始能量』。放射狀的花蕊象徵妳永不枯竭的好奇心，不斷向外探索生命的多元邊界。", vessel: "artisan pottery pot" },
            { name: "虞美人", latin: "Papaver rhoeas", meaning: "『脆弱中的韌性』。薄如蟬翼的花瓣在風中顫抖卻不凋零，象徵妳懷抱恐懼卻依然堅定的勇氣。", vessel: "slender bud vase" },
            { name: "蝴蝶蘭", latin: "Phalaenopsis amabilis", meaning: "妳是『優雅的恆久性』。平滑如絲的花瓣象徵妳對高品質生活的堅持，以及在動盪中維持優雅的能力。", vessel: "custom slate tray" },
            { name: "風鈴草", latin: "Campanula medium", meaning: "『溫柔的傾聽者』。低垂的花序如同捕捉風的聲音，象徵妳善於觀察與共情的避風港特質。", vessel: "organic glass bowl" },
            { name: "文心蘭", latin: "Oncidium", meaning: "『躍動的自由靈魂』。如舞者在枝頭盤旋，象徵妳天生熱愛自由，不願被任何枯燥的框架束縛。", vessel: "bamboo accent holder" }
        ];

        const extensionFlowers = [
            ["薰衣草", "Lavandula", "『沈穩的療癒力』。不張揚的花穗散發撫平焦慮的氣息，妳的存在本身就是一種撫慰。", "linen ceramic pot"],
            ["康乃馨", "Dianthus caryophyllus", "『溫柔的厚度』。層疊的花瓣象徵豐沛的情感儲備，妳總是默默守護。", "milk glass vase"],
            ["百合", "Lilium", "『聖潔的強勢感』。碩大的花型象徵妳靈魂中不可忽視的正向能量。", "stone pedestal"],
            ["文竹", "Asparagus setaceus", "『細密的心思』。如雲霧般的細葉象徵妳極其細膩的感受力。", "bonsai ceramic tray"],
            ["尤加利", "Eucalyptus", "『清冽的醒悟』。獨特涼香象徵妳隨時能找回冷靜與清晰判斷。", "spray glass bottle"],
            ["龜背竹", "Monstera deliciosa", "『野性的秩序』。巨大的裂葉象徵妳廣闊的包容力與野心。", "large terracotta pot"],
            ["山茶花", "Camellia japonica", "『含蓄的堅毅』。花瓣整齊排列，象徵妳靈魂中得體且具尊嚴的起落。", "lacquer red tray"],
            ["滿天星", "Gypsophila", "『微小的光芒』。細碎的花朵聚集成雲，象徵妳那種點亮周遭的細膩溫柔。", "beaker glass vase"],
            ["鬱金香", "Tulipa", "『收斂的尊貴』。直立且含蓄的花型，代表妳在繁華中依然能維持清醒與自律。", "crystal cylinder"],
            ["木蓮", "Magnolia", "『高潔的靜謐』。碩大的花瓣象徵妳大氣而穩重的生命格局。", "hand-thrown clay pot"]
        ];

        extensionFlowers.forEach(f => flowers.push({ name: f[0], latin: f[1], meaning: f[2], vessel: f[3] }));

        // 填充至 100 種純淨數據 (不再使用「變奏」字樣)
        const fillerPlants = ["朱槿", "桂花", "雞蛋花", "睡蓮", "含羞草", "茉莉", "水仙", "彼岸花", "空氣鳳梨", "鹿角蕨", "波斯菊", "藍星花", "飛燕草", "鼠尾草", "迷迭香", "薄荷", "金盞花", "紫羅蘭", "非洲菊", "文心蘭", "夜來香", "曼陀羅", "月見草", "金銀花", "忍冬", "艾草", "銀葉菊", "火鶴", "萬代蘭", "拖鞋蘭", "毛地黃", "毛茛", "大王蓮", "銀杏", "楓葉", "翠菊", "矢車菊", "蒲公英", "風信子", "杜鵑", "石斛蘭", "連翹", "丁香", "瑞香", "龍膽", "薊花", "洋甘菊", "靈芝", "石蓮", "合果芋", "火炬花", "羅漢松", "翠柏", "銀葉桉", "銀脈茉莉", "珊瑚藤", "百里香", "香蜂草", "大葉蟻塔", "魯冰花", "連錢草", "金魚草", "風铃花", "錦葵", "凌霄花", "木棉花", "鳳凰木", "含笑花", "梔子花", "天堂鳥"];

        fillerPlants.forEach(name => {
            if(flowers.length < 100) {
                flowers.push({
                    name: name,
                    latin: name + " species",
                    meaning: `身為『${name}』，妳的生命質地帶有一種不可被複刻的獨特性。這象徵著妳總能找到屬於自己的著陸點，以最自在的姿態，去經歷每一場花季。`,
                    vessel: "artisan matte pottery on stone"
                });
            }
        });

        function getSolarTermByDate(month, day) {
            const solarTerms = [
                { name: "小寒", m: 1, d: 5 }, { name: "大寒", m: 1, d: 20 },
                { name: "立春", m: 2, d: 4 }, { name: "雨水", m: 2, d: 19 },
                { name: "驚蟄", m: 3, d: 5 }, { name: "春分", m: 3, d: 20 },
                { name: "清明", m: 4, d: 5 }, { name: "穀雨", m: 4, d: 20 },
                { name: "立夏", m: 5, d: 5 }, { name: "小滿", m: 5, d: 21 },
                { name: "芒種", m: 6, d: 6 }, { name: "夏至", m: 6, d: 21 },
                { name: "小暑", m: 7, d: 7 }, { name: "大暑", m: 7, d: 23 },
                { name: "立秋", m: 8, d: 7 }, { name: "處暑", m: 8, d: 23 },
                { name: "白露", m: 9, d: 8 }, { name: "秋分", m: 9, d: 23 },
                { name: "寒露", m: 10, d: 8 }, { name: "霜降", m: 10, d: 23 },
                { name: "立冬", m: 11, d: 7 }, { name: "小雪", m: 11, d: 22 },
                { name: "大雪", m: 12, d: 7 }, { name: "冬至", m: 12, d: 22 }
            ];
            for (let i = 0; i < solarTerms.length; i++) {
                if (month < solarTerms[i].m || (month === solarTerms[i].m && day < solarTerms[i].d)) {
                    return i === 0 ? "冬至" : solarTerms[i-1].name;
                }
            }
            return "冬至";
        }

        function updateDateDisplay() {
            const dateVal = document.getElementById('datePicker').value;
            if (dateVal) {
                const d = new Date(dateVal);
                document.getElementById('dateText').innerText = `${d.getFullYear()} / ${d.getMonth()+1} / ${d.getDate()}`;
                document.getElementById('dateText').className = "text-stone-700 font-bold tracking-widest";
            }
        }

        async function startHealingAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') await audioCtx.resume();
            const now = audioCtx.currentTime;
            document.getElementById('audioVisualizer').classList.add('active');
            
            const playBowl = (freq, vol) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(freq, now);
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(vol, now + 3);
                gain.gain.exponentialRampToValueAtTime(0.0001, now + 15);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(now); osc.stop(now + 15);
            };

            playBowl(174, 0.08); 
            playBowl(528, 0.03); 
            
            setTimeout(() => { 
                document.getElementById('audioVisualizer').classList.remove('active'); 
            }, 15000);
        }

        async function runOracle() {
            const dateVal = document.getElementById('datePicker').value;
            if(!dateVal) return;
            startHealingAudio(); 

            const birthDate = new Date(dateVal);
            const y = birthDate.getFullYear(), m = birthDate.getMonth() + 1, d = birthDate.getDate();
            const seed = (y * 17) + (m * 11) + (d * 3);
            const flower = flowers[seed % flowers.length];
            const termName = getSolarTermByDate(m, d);

            document.getElementById('resultArea').classList.remove('hidden');
            document.getElementById('resName').innerText = flower.name;
            document.getElementById('latinName').innerText = flower.latin;
            document.getElementById('botanicalTag').classList.remove('hidden');
            document.getElementById('resMeaning').innerText = flower.meaning;
            document.getElementById('resAction').innerText = `【${termName}】${solarTermInsights[termName]}`;
            document.getElementById('resCoord').innerText = `Trace #${y}${m < 10 ? '0' : ''}${m}${d < 10 ? '0' : ''}${d}`;

            const img = document.getElementById('flowerImage');
            const load = document.getElementById('loadingOverlay');
            img.classList.add('hidden'); load.classList.remove('hidden');
            
            const promptText = `Professional editorial photograph of a single ${flower.name} (${flower.latin}) in a ${flower.vessel}. ${coreStyle}`;

            try {
                const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ instances: [{ prompt: promptText }], parameters: { sampleCount: 1 } })
                });
                const data = await resp.json();
                if(data.predictions?.[0]) {
                    img.src = `data:image/png;base64,${data.predictions[0].bytesBase64Encoded}`;
                    img.classList.remove('hidden');
                }
            } catch (e) {} finally { load.classList.add('hidden'); }
            
            window.scrollTo({ top: document.getElementById('resultArea').offsetTop - 30, behavior: 'smooth' });
        }
    </script>

</body></html>